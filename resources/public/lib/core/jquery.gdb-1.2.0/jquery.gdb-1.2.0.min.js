!function(){var gdbFactory=function(jQuery){var $=jQuery,GDB=function(modelsToMonitorObject,userOptionsObject){var GDB=this;GDB.helpers={isEventSupported:function(e){var t={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"},n=document.createElement(t[e]||"div");e="on"+e;var o=e in n;return o||(n.setAttribute(e,"return;"),o="function"==typeof n[e]),n=null,o}};var options={rootElementSelectorString:"body",templateOpeningDelimiter:"<<",templateClosingDelimiter:">>",realtime:!0,dataBindToAttr:"data-bindto",dataWatchingAttr:"data-watching",dataBindToTemplateAttr:"data-bindto-template",dataParseWithAttr:"data-parsewith",bindAsTextOnly:!1,insertPolyfills:!0,debugLogging:!1,modelChangeCallback:null,elementChangeCallback:null};void 0!==userOptionsObject&&(options=$.extend(options,userOptionsObject)),options.insertPolyfills===!0&&loadPolyFills();var modelsToMonitor=modelsToMonitorObject;GDB.getBoundElementFromModelPath=function(e){return $("["+options.dataBindToAttr+"="+e+"]")},GDB.getModelPathFromBoundElement=function(e){var t=$(e);return t.is("["+options.dataBindToAttr+"]")?t.attr(options.dataBindToAttr):!1},GDB.getValueFromModelPath=function(e){var t=$.extend(!0,{},modelsToMonitor);e=e.replace(/\[(\w+)\]/g,".$1"),e=e.replace(/^\./,"");for(var n=e.split(".");n.length;){var o=n.shift();if(!(o in t))return;t=t[o]}return t};var listenForEvents=(options.realtime?(GDB.helpers.isEventSupported("input")?"input":"keyup")+" paste ":"")+" change blur";$(options.rootElementSelectorString).on(listenForEvents,"["+options.dataBindToAttr+"],["+options.dataBindToTemplateAttr+"],["+options.dataParseWithAttr+"]",function(e){var $this=$(this),value="";if($this.is("["+options.dataBindToAttr+"],["+options.dataParseWithAttr+"]")){var modelLocation=$this.attr(options.dataBindToAttr);value=$this.is("input,select,textarea")?$this.is(":checkbox")?$("["+options.dataBindToAttr+"='"+$this.attr(options.dataBindToAttr)+"'][name='"+$this.attr("name")+"']:checked").map(function(){return $(this).val()}).toArray():$this.val():options.bindAsTextOnly?$this.text():$this.html(),value=$.isArray(value)?JSON.stringify(value):"'"+value.replace(/'/g,"\\'").replace(/\n/g,"\\n")+"'",modelLocation&&eval("modelsToMonitor."+modelLocation+"="+value),$this.is("["+options.dataParseWithAttr+"]")&&eval("modelsToMonitor."+$this.attr(options.dataParseWithAttr)+".out("+value+")"),options.debugLogging&&console.log(modelLocation+" is now equal to "+value+' as per changes made in the view as witnessed by the "'+e.type+'" event.'),"function"==typeof options.elementChangeCallback?(options.debugLogging&&console.log("Bound element change callback executed for change in "+modelLocation),options.elementChangeCallback({locationPathString:modelLocation,$boundElement:$this,newValue:options.bindAsTextOnly?$this.text():$this.html()})):options.debugLogging&&console.log("No callback supplied for bound element change thus no function was called")}});var observeObjects=function(objectToObserve,objectLocationString,previousObjects){previousObjects=previousObjects||[],$.each(objectToObserve,function(key,value){if(null!==value&&("object"==typeof value||value instanceof Array)&&function(){var e=!0;return previousObjects.forEach(function(t){t===value&&(e=!1)}),e}()){previousObjects.push(value);var thisLocation="";thisLocation="undefined"==typeof objectLocationString?""+key:isNaN(key)?objectLocationString+"."+key:objectLocationString+"["+key+"]",Object.observe(value,function(changes){changes.forEach(function(change){var key=isNaN(change.name)?"."+change.name:"["+change.name+"]",modelPath=thisLocation+key,elementSelector="["+options.dataBindToAttr+"='"+modelPath+"'],["+options.dataWatchingAttr+"*='"+modelPath+",'],["+options.dataWatchingAttr+"$='"+modelPath+"']",newValue=change.object[change.name],oldValue=change.type;if(("object"==typeof newValue||newValue instanceof Array)&&observeObjects(value,thisLocation,previousObjects),$(elementSelector).each(function(){newValue=$(this).is("["+options.dataWatchingAttr+"]["+options.dataParseWithAttr+"]")?eval("modelsToMonitor."+$(this).attr(options.dataParseWithAttr)+".in()"):change.object[change.name],console.log(newValue),$(this).is("input,select,textarea")?$(this).is(":checkbox")?$(elementSelector).each(function(){var e=$(this),t=!1;newValue.forEach(function(n){e.val()==n&&(e.is(":checked")||e.attr("checked","checked"),t=!0)}),t||e.removeAttr("checked")}):$(this).is(":radio")?$(elementSelector).each(function(){var e=$(this);e.val()==newValue?e.attr("checked","checked"):e.removeAttr("checked")}):$(this).val()!=newValue&&$(this).val(newValue):options.bindAsTextOnly?$(this).text()!=newValue&&$(this).text(newValue):$(this).html()!=newValue&&$(this).html(newValue)}),$.isArray(newValue))var logValue=JSON.stringify(newValue);else var logValue="'"+newValue+"'";options.debugLogging&&console.log(thisLocation+key+" is now equal to "+logValue+" as observed in the model."),"function"==typeof options.modelChangeCallback?(options.debugLogging&&console.log("Model change callback executed for change in "+thisLocation+key),options.modelChangeCallback({locationPathString:modelPath,$boundElements:$(elementSelector),newValue:newValue,oldValue:oldValue})):options.debugLogging&&console.log("No callback supplied for model change thus no function was called")})}),observeObjects(value,thisLocation,previousObjects)}})};observeObjects(modelsToMonitor)},loadPolyFills=function(){Object.observe||!function(e,t){function n(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName}var o=function(e){var n=e.call(e),o=typeof o;return"object"==typeof t.alert?function(t){return n===e.call(t)||!!t&&typeof t.toString==o&&typeof t.valueOf==o&&/^\s*\bfunction\b/.test(""+t)}:function(t){return n===e.call(t)}}(e.prototype.toString),i=function(){return!!t.setImmediate}(),a=function(){return i?function(e){return setImmediate(e)}:function(e){return setTimeout(e,10)}}(),r=function(){return i?function(e){clearImmediate(e)}:function(e){clearTimeout(e)}}(),c=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},l=function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t},s=function(e){return"undefined"==typeof e?!1:"get"in e||"set"in e},u=function(e,t){if("object"!=typeof e)throw new TypeError("Object.observeObject called on non-object");if(o(t)===!1)throw new TypeError("Object.observeObject: Expecting function");if(Object.isFrozen(t)===!0)throw new TypeError("Object.observeObject: Expecting unfrozen function")},d=function(){var e=[],t=function(t,n){u(t,n),Object.getNotifier(t).addListener(n),-1===e.indexOf(t)?e.push(t):Object.getNotifier(t)._checkPropertyListing()};t.prototype.deliverChangeRecords=function(e){Object.getNotifier(e).deliverChangeRecords()},e.lastScanned=0;var n=function(e){return function(){var t=0,o=e.length,i=new Date,r=!1;for(t=e.lastScanned;o>t&&!r;t++)Object.getNotifier(e[t])._checkPropertyListing(),r=new Date-i>100;e.lastScanned=o>t?t:0,a(n)}}(e);return a(n),t}(),h=function(e){var t=[],n=[],o=!1,i=[],u=[],d=this;Object.defineProperty(d,"_watching",{enumerable:!0,get:function(e){return function(){return e}}(e)});var h=function(e,t){var n=(typeof e[t],Object.getOwnPropertyDescriptor(e,t));if("getNotifier"===t||s(n)||!n.enumerable)return!1;if(e instanceof Array&&c(t)){var o=i.length;return i[o]=t,u[o]=e[t],!0}return function(t,n){i[t]=n,u[t]=e[n],Object.defineProperty(e,n,{get:function(){return u[t]},set:function(o){l(u[t],o)||(Object.getNotifier(e).queueUpdate(e,n,"updated",u[t]),u[t]=o)}})}(i.length,t),!0};d._checkPropertyListing=function(e){var t,n,o,a,r,l=d._watching,s=Object.keys(l),f=0,p=s.length,g=i.slice(0),b=!e;for(l instanceof Array&&(r=i.length),f=0;p>f;f++)t=s[f],o=l[t],n=typeof o,-1===(a=i.indexOf(t))?h(l,t)&&b&&d.queueUpdate(l,t,"new",null,l[t]):(l instanceof Array&&c(t)&&u[a]!==o&&(b&&d.queueUpdate(l,t,"updated",u[a],o),u[a]=o),g.splice(g.indexOf(t),1));if(l instanceof Array&&l.length!==r&&b&&d.queueUpdate(l,"length","updated",r,l),b)for(p=g.length,f=0;p>f;f++)a=i.indexOf(g[f]),d.queueUpdate(l,g[f],"deleted",u[a]),i.splice(a,1),u.splice(a,1)},d.addListener=function(e){var n=t.indexOf(e);-1===n&&t.push(e)},d.removeListener=function(e){var n=t.indexOf(e);n>-1&&t.splice(n,1)},d.listeners=function(){return t},d.queueUpdate=function(e,t,n,o){this.queueUpdates([{type:n,object:e,name:t,oldValue:o}])},d.queueUpdates=function(e){var t,i=this,c=0,l=e.length||0;for(c=0;l>c;c++)t=e[c],n.push(t);o&&r(o),o=a(function(){o=!1,i.deliverChangeRecords()})},d.deliverChangeRecords=function(){var e=0,o=t.length;for(e=0;o>e;e++)t[e]&&(t[e]===console.log?console.log(n):t[e](n));n=[]},d._checkPropertyListing(!0)},f=[],p=[];e.getNotifier=function(e){var t=p.indexOf(e),n=t>-1?f[t]:!1;return n||(t=p.length,p[t]=e,n=f[t]=new h(e)),n},e.observe=function(e,t){return n(e)?void 0:new d(e,t)},e.unobserve=function(e,t){u(e,t);var n=p.indexOf(e),o=n>-1?f[n]:!1;o&&(o.removeListener(t),0===o.listeners().length&&(p.splice(n,1),f.splice(n,1)))}}(Object,this)};return GDB};"function"==typeof define&&define.amd?define("gdb",["jquery"],function(e){return gdbFactory(e)}):jQuery(function(){window.GDB=gdbFactory(window.jQuery)})}();